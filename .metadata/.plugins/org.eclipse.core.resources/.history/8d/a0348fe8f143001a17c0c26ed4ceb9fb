package com.board.icia.service;
//회원관리 서비스 클래스(model)

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.stereotype.Component;
import org.springframework.stereotype.Service;
import org.springframework.web.servlet.ModelAndView;

import com.board.icia.dao.IMemberDao;
import com.board.icia.dto.Member;

//@Component
@Service
public class MemberManagement {
	@Autowired
	private IMemberDao mDao;
	
	private ModelAndView mav;
	public ModelAndView memberAccess(Member mb) {
		mav = new ModelAndView();
		String view = null;
		if(mDao.getLoginResult(mb)) {
			System.out.println("true");
			mav.addObject("result","로그인 성공"); //로그인 성공 1
			view="boardList";
		}else {
			mav.addObject("result","로그인 실패"); //로그인 실패 2
			view="home";
		}
		mav.setViewName(view);
		return mav;
	}
	public ModelAndView memberjoin(Member mb) {
		mav=new ModelAndView();
		String view=null;
		//Encoder(암호화) <-->Decoder(복구화)
		//스프링은 암호화는 가능하지만 복구가안됨
		BCryptPasswordEncoder pwdEncoder=new BCryptPasswordEncoder();
		//비번만 암호화해서 DB저장
		mb.setM_pwd(pwdEncoder.encode(mb.getM_pwd()));
		if(mDao.memberJoin(mb)) {
			view = "home"; //회원가입 성공시
		}else {
			view = "memberjoin"; //회원가입 실패시
		}
		return mav;
	}

}//Class End